city                          : boston
simulation_num                : 5000000
test_simulation_num           : 1000
total_trajectories            : 1
capacity_scale                : 10
weight_quantization_scale     : None
max_connection                : 3
train_data_dir                : ./data/
test_data_dir                 : ./data_test/
use_given_data                : True
batch_size                    : 256
test_size                     : 500
path_num                      : 1
block_size                    : 51
observe_ratio                 : 0.2
special_mask_value            : 0.0001
n_embd                        : 64
n_head                        : 16
n_layer                       : 8
dropout                       : 0.0
use_adj_table                 : True
max_iters                     : 100000
learning_rate                 : 0.1
lr_drop_rate                  : 0.5
eval_freq                     : 100
save_freq                     : 5
device                        : cuda:2
load_dir                      : ./checkpoints_mae/
load_dir_id                   : 0
data num: 5000000
Encoded trajectory loaded, time: 171.75842690467834
data num: 1000
Encoded trajectory loaded, time: 0.24184250831604004
Data loaded in 314.04647517204285 seconds
Model loaded in 0.307483434677124 seconds
start training from iteration 0
Iteration 1000      |  Loss: 3.59461927  |  Acc: 74.15%   |  Test Loss: 3.61329436  |  Test Acc: 29.96%   |  Real True Rate: 0.20%    |
Iteration 2000      |  Loss: 4.48745298  |  Acc: 73.75%   |  Test Loss: 4.43742323  |  Test Acc: 18.49%   |  Real True Rate: 0.00%    |
Iteration 3000      |  Loss: 3.68918228  |  Acc: 77.14%   |  Test Loss: 3.66864896  |  Test Acc: 29.89%   |  Real True Rate: 0.40%    |
Iteration 4000      |  Loss: 3.56799150  |  Acc: 76.71%   |  Test Loss: 3.63353467  |  Test Acc: 30.06%   |  Real True Rate: 0.00%    |
Iteration 5000      |  Loss: 3.70837617  |  Acc: 74.78%   |  Test Loss: 3.59337783  |  Test Acc: 30.05%   |  Real True Rate: 0.00%    |
Iteration 6000      |  Loss: 3.37356257  |  Acc: 71.34%   |  Test Loss: 3.30429339  |  Test Acc: 31.50%   |  Real True Rate: 0.00%    |
Iteration 7000      |  Loss: 3.35736990  |  Acc: 75.62%   |  Test Loss: 3.07126617  |  Test Acc: 32.22%   |  Real True Rate: 0.00%    |
Iteration 8000      |  Loss: 2.73342586  |  Acc: 78.41%   |  Test Loss: 2.90045619  |  Test Acc: 33.04%   |  Real True Rate: 0.00%    |
Iteration 9000      |  Loss: 2.58925200  |  Acc: 77.26%   |  Test Loss: 2.81637216  |  Test Acc: 33.23%   |  Real True Rate: 0.00%    |
Iteration 10000     |  Loss: 2.49374199  |  Acc: 75.56%   |  Test Loss: 2.73396063  |  Test Acc: 34.56%   |  Real True Rate: 0.00%    |
Iteration 11000     |  Loss: 2.45720458  |  Acc: 73.34%   |  Test Loss: 2.42069292  |  Test Acc: 36.80%   |  Real True Rate: 0.20%    |
Iteration 12000     |  Loss: 2.23377800  |  Acc: 69.98%   |  Test Loss: 2.32763648  |  Test Acc: 39.28%   |  Real True Rate: 0.00%    |
Iteration 13000     |  Loss: 2.19773054  |  Acc: 67.80%   |  Test Loss: 2.15552568  |  Test Acc: 42.45%   |  Real True Rate: 0.00%    |
Iteration 14000     |  Loss: 2.03238392  |  Acc: 69.67%   |  Test Loss: 2.01058030  |  Test Acc: 45.01%   |  Real True Rate: 0.00%    |
Iteration 15000     |  Loss: 1.99800110  |  Acc: 72.57%   |  Test Loss: 2.07081962  |  Test Acc: 43.97%   |  Real True Rate: 0.00%    |
Iteration 16000     |  Loss: 1.88743615  |  Acc: 68.32%   |  Test Loss: 1.87362444  |  Test Acc: 49.10%   |  Real True Rate: 0.00%    |
Iteration 17000     |  Loss: 1.94771218  |  Acc: 68.87%   |  Test Loss: 2.06495166  |  Test Acc: 44.68%   |  Real True Rate: 0.00%    |
Iteration 18000     |  Loss: 1.63233888  |  Acc: 74.43%   |  Test Loss: 1.88019156  |  Test Acc: 48.75%   |  Real True Rate: 0.00%    |
Iteration 19000     |  Loss: 1.62255800  |  Acc: 72.08%   |  Test Loss: 1.76620364  |  Test Acc: 52.77%   |  Real True Rate: 0.00%    |
Iteration 20000     |  Loss: 1.56228030  |  Acc: 73.80%   |  Test Loss: 1.66170812  |  Test Acc: 54.36%   |  Real True Rate: 0.00%    |
Model saved at iteration 20000
Next learning rate: 0.09045084971874769
Iteration 21000     |  Loss: 1.66854513  |  Acc: 75.35%   |  Test Loss: 1.70480740  |  Test Acc: 54.53%   |  Real True Rate: 0.00%    |
Iteration 22000     |  Loss: 1.94932640  |  Acc: 74.55%   |  Test Loss: 2.16007471  |  Test Acc: 44.22%   |  Real True Rate: 0.00%    |
Iteration 23000     |  Loss: 2.59440041  |  Acc: 72.96%   |  Test Loss: 2.59782577  |  Test Acc: 38.36%   |  Real True Rate: 0.00%    |
Iteration 24000     |  Loss: 1.93008482  |  Acc: 69.70%   |  Test Loss: 1.87297332  |  Test Acc: 51.50%   |  Real True Rate: 0.00%    |
Iteration 25000     |  Loss: 1.32978499  |  Acc: 75.29%   |  Test Loss: 1.56758678  |  Test Acc: 58.31%   |  Real True Rate: 0.00%    |
Iteration 26000     |  Loss: 1.33874893  |  Acc: 78.28%   |  Test Loss: 1.48479784  |  Test Acc: 60.24%   |  Real True Rate: 0.00%    |
Iteration 27000     |  Loss: 1.66997361  |  Acc: 74.60%   |  Test Loss: 2.05698442  |  Test Acc: 46.58%   |  Real True Rate: 0.00%    |
Iteration 28000     |  Loss: 1.59119713  |  Acc: 73.70%   |  Test Loss: 1.46070433  |  Test Acc: 60.46%   |  Real True Rate: 0.20%    |
Iteration 29000     |  Loss: 1.50535667  |  Acc: 82.15%   |  Test Loss: 1.58985043  |  Test Acc: 57.90%   |  Real True Rate: 0.40%    |
Iteration 30000     |  Loss: 1.21649146  |  Acc: 77.21%   |  Test Loss: 1.33953321  |  Test Acc: 64.61%   |  Real True Rate: 0.20%    |
Iteration 31000     |  Loss: 1.24539340  |  Acc: 74.94%   |  Test Loss: 1.41328013  |  Test Acc: 61.67%   |  Real True Rate: 0.00%    |
Iteration 32000     |  Loss: 1.36466205  |  Acc: 76.65%   |  Test Loss: 1.68562329  |  Test Acc: 55.91%   |  Real True Rate: 0.00%    |
Iteration 33000     |  Loss: 1.55256045  |  Acc: 76.85%   |  Test Loss: 1.70264912  |  Test Acc: 56.42%   |  Real True Rate: 0.00%    |
Iteration 34000     |  Loss: 1.18129337  |  Acc: 78.42%   |  Test Loss: 1.37634468  |  Test Acc: 62.97%   |  Real True Rate: 0.00%    |
Iteration 35000     |  Loss: 1.27029431  |  Acc: 77.90%   |  Test Loss: 1.55851698  |  Test Acc: 59.36%   |  Real True Rate: 0.20%    |
Iteration 36000     |  Loss: 1.29124475  |  Acc: 72.23%   |  Test Loss: 1.37651682  |  Test Acc: 62.74%   |  Real True Rate: 0.00%    |
Iteration 37000     |  Loss: 1.14586318  |  Acc: 74.75%   |  Test Loss: 1.36349094  |  Test Acc: 64.38%   |  Real True Rate: 0.00%    |
Iteration 38000     |  Loss: 1.15233803  |  Acc: 75.95%   |  Test Loss: 1.25361550  |  Test Acc: 65.83%   |  Real True Rate: 0.00%    |
Iteration 39000     |  Loss: 1.19744086  |  Acc: 75.17%   |  Test Loss: 1.41093814  |  Test Acc: 60.39%   |  Real True Rate: 0.00%    |
Iteration 40000     |  Loss: 1.23033142  |  Acc: 76.00%   |  Test Loss: 1.41817653  |  Test Acc: 61.54%   |  Real True Rate: 0.20%    |
Model saved at iteration 40000
Next learning rate: 0.06545084971874847
Iteration 41000     |  Loss: 1.26430416  |  Acc: 78.46%   |  Test Loss: 1.54818487  |  Test Acc: 60.22%   |  Real True Rate: 0.00%    |
Iteration 42000     |  Loss: 1.21940815  |  Acc: 77.14%   |  Test Loss: 1.20930243  |  Test Acc: 66.95%   |  Real True Rate: 0.00%    |
Iteration 43000     |  Loss: 1.31407928  |  Acc: 77.67%   |  Test Loss: 1.28982258  |  Test Acc: 66.04%   |  Real True Rate: 0.00%    |
Iteration 44000     |  Loss: 1.35545027  |  Acc: 76.63%   |  Test Loss: 1.24440265  |  Test Acc: 66.81%   |  Real True Rate: 0.20%    |
Iteration 45000     |  Loss: 1.16461682  |  Acc: 77.37%   |  Test Loss: 1.31635463  |  Test Acc: 65.90%   |  Real True Rate: 0.40%    |
Iteration 46000     |  Loss: 1.00631213  |  Acc: 78.75%   |  Test Loss: 1.21800518  |  Test Acc: 66.93%   |  Real True Rate: 0.00%    |
Iteration 47000     |  Loss: 0.99548304  |  Acc: 76.78%   |  Test Loss: 1.17459357  |  Test Acc: 68.97%   |  Real True Rate: 0.00%    |
Iteration 48000     |  Loss: 1.19815314  |  Acc: 78.42%   |  Test Loss: 1.37382662  |  Test Acc: 63.20%   |  Real True Rate: 0.00%    |
Iteration 49000     |  Loss: 0.99792677  |  Acc: 75.48%   |  Test Loss: 1.24439704  |  Test Acc: 67.43%   |  Real True Rate: 0.20%    |
Iteration 50000     |  Loss: 1.19677198  |  Acc: 74.14%   |  Test Loss: 1.16278088  |  Test Acc: 67.97%   |  Real True Rate: 0.00%    |
Iteration 51000     |  Loss: 1.04573393  |  Acc: 76.43%   |  Test Loss: 1.24712706  |  Test Acc: 65.50%   |  Real True Rate: 0.00%    |
Iteration 52000     |  Loss: 0.92124641  |  Acc: 78.81%   |  Test Loss: 1.11987948  |  Test Acc: 68.75%   |  Real True Rate: 0.20%    |
Iteration 53000     |  Loss: 1.16700637  |  Acc: 76.95%   |  Test Loss: 1.19082034  |  Test Acc: 68.30%   |  Real True Rate: 0.40%    |
Iteration 54000     |  Loss: 1.01455545  |  Acc: 79.15%   |  Test Loss: 1.16638196  |  Test Acc: 67.23%   |  Real True Rate: 0.20%    |
Iteration 55000     |  Loss: 1.01143718  |  Acc: 77.35%   |  Test Loss: 1.13949263  |  Test Acc: 69.00%   |  Real True Rate: 0.00%    |
Iteration 56000     |  Loss: 1.01421130  |  Acc: 76.43%   |  Test Loss: 1.09649527  |  Test Acc: 69.26%   |  Real True Rate: 0.20%    |
Iteration 57000     |  Loss: 1.01144361  |  Acc: 77.54%   |  Test Loss: 1.09458959  |  Test Acc: 70.57%   |  Real True Rate: 0.40%    |
Iteration 58000     |  Loss: 0.92866772  |  Acc: 75.12%   |  Test Loss: 1.06633365  |  Test Acc: 69.86%   |  Real True Rate: 0.00%    |
Iteration 59000     |  Loss: 1.02107489  |  Acc: 75.41%   |  Test Loss: 1.24869299  |  Test Acc: 66.95%   |  Real True Rate: 0.20%    |
Iteration 60000     |  Loss: 1.05428565  |  Acc: 75.93%   |  Test Loss: 1.20252311  |  Test Acc: 66.39%   |  Real True Rate: 0.20%    |
Model saved at iteration 60000
Next learning rate: 0.03454915028125373
Iteration 61000     |  Loss: 1.09119308  |  Acc: 77.02%   |  Test Loss: 1.18028796  |  Test Acc: 67.26%   |  Real True Rate: 0.00%    |
Iteration 62000     |  Loss: 1.00754058  |  Acc: 76.04%   |  Test Loss: 1.24338567  |  Test Acc: 65.78%   |  Real True Rate: 0.20%    |
Iteration 63000     |  Loss: 0.90873456  |  Acc: 79.35%   |  Test Loss: 1.05341029  |  Test Acc: 71.20%   |  Real True Rate: 1.00%    |
Iteration 64000     |  Loss: 0.91780621  |  Acc: 77.76%   |  Test Loss: 1.14126229  |  Test Acc: 68.22%   |  Real True Rate: 0.40%    |
Iteration 65000     |  Loss: 0.86632299  |  Acc: 79.43%   |  Test Loss: 1.06183624  |  Test Acc: 70.51%   |  Real True Rate: 0.20%    |
Iteration 66000     |  Loss: 0.94456577  |  Acc: 79.79%   |  Test Loss: 1.07343888  |  Test Acc: 69.45%   |  Real True Rate: 0.00%    |
Iteration 67000     |  Loss: 1.02489793  |  Acc: 77.97%   |  Test Loss: 1.06442583  |  Test Acc: 71.99%   |  Real True Rate: 0.40%    |
Iteration 68000     |  Loss: 0.98186213  |  Acc: 75.85%   |  Test Loss: 1.18448257  |  Test Acc: 67.37%   |  Real True Rate: 0.40%    |
Iteration 69000     |  Loss: 0.86474216  |  Acc: 76.90%   |  Test Loss: 1.14886153  |  Test Acc: 68.48%   |  Real True Rate: 0.20%    |
Iteration 70000     |  Loss: 0.79261339  |  Acc: 80.86%   |  Test Loss: 1.00218260  |  Test Acc: 72.21%   |  Real True Rate: 0.00%    |
Iteration 71000     |  Loss: 0.82749790  |  Acc: 78.18%   |  Test Loss: 1.06077719  |  Test Acc: 71.23%   |  Real True Rate: 0.00%    |
Iteration 72000     |  Loss: 0.92817628  |  Acc: 79.40%   |  Test Loss: 1.11392200  |  Test Acc: 68.95%   |  Real True Rate: 0.40%    |
Iteration 73000     |  Loss: 0.80353975  |  Acc: 79.07%   |  Test Loss: 1.03719342  |  Test Acc: 72.62%   |  Real True Rate: 0.60%    |
Iteration 74000     |  Loss: 1.05060613  |  Acc: 72.48%   |  Test Loss: 1.10392284  |  Test Acc: 68.49%   |  Real True Rate: 0.00%    |
Iteration 75000     |  Loss: 0.79143226  |  Acc: 79.83%   |  Test Loss: 1.02399576  |  Test Acc: 72.99%   |  Real True Rate: 0.20%    |
Iteration 76000     |  Loss: 0.84968859  |  Acc: 76.30%   |  Test Loss: 0.93407172  |  Test Acc: 73.38%   |  Real True Rate: 0.60%    |
Iteration 77000     |  Loss: 0.85471028  |  Acc: 78.26%   |  Test Loss: 1.02060115  |  Test Acc: 72.51%   |  Real True Rate: 1.00%    |
Iteration 78000     |  Loss: 0.75532818  |  Acc: 79.62%   |  Test Loss: 0.94919217  |  Test Acc: 72.67%   |  Real True Rate: 0.60%    |
Iteration 79000     |  Loss: 0.78572357  |  Acc: 79.37%   |  Test Loss: 0.99385047  |  Test Acc: 74.05%   |  Real True Rate: 0.00%    |
Iteration 80000     |  Loss: 0.73946875  |  Acc: 78.37%   |  Test Loss: 0.95601642  |  Test Acc: 72.95%   |  Real True Rate: 0.60%    |
Model saved at iteration 80000
Next learning rate: 0.009549150281252953
Iteration 81000     |  Loss: 0.84003866  |  Acc: 76.34%   |  Test Loss: 1.02804077  |  Test Acc: 73.34%   |  Real True Rate: 0.00%    |
Iteration 82000     |  Loss: 0.76355064  |  Acc: 79.79%   |  Test Loss: 0.91874629  |  Test Acc: 73.93%   |  Real True Rate: 0.80%    |
Iteration 83000     |  Loss: 0.72877616  |  Acc: 78.55%   |  Test Loss: 0.96048576  |  Test Acc: 73.52%   |  Real True Rate: 0.40%    |
Iteration 84000     |  Loss: 0.78187448  |  Acc: 78.90%   |  Test Loss: 0.91572130  |  Test Acc: 73.52%   |  Real True Rate: 0.20%    |
Iteration 85000     |  Loss: 0.68882793  |  Acc: 78.73%   |  Test Loss: 0.95520574  |  Test Acc: 74.54%   |  Real True Rate: 0.20%    |
Iteration 86000     |  Loss: 0.64477795  |  Acc: 78.15%   |  Test Loss: 0.87583262  |  Test Acc: 74.96%   |  Real True Rate: 0.40%    |
Iteration 87000     |  Loss: 0.70815766  |  Acc: 79.16%   |  Test Loss: 0.92551428  |  Test Acc: 76.13%   |  Real True Rate: 0.40%    |
Iteration 88000     |  Loss: 0.74218696  |  Acc: 76.29%   |  Test Loss: 0.87537116  |  Test Acc: 75.03%   |  Real True Rate: 0.40%    |
Iteration 89000     |  Loss: 0.77874744  |  Acc: 79.76%   |  Test Loss: 0.93008482  |  Test Acc: 75.85%   |  Real True Rate: 0.40%    |
Iteration 90000     |  Loss: 0.67727029  |  Acc: 81.14%   |  Test Loss: 0.86135316  |  Test Acc: 75.12%   |  Real True Rate: 0.60%    |
Iteration 91000     |  Loss: 0.68770152  |  Acc: 80.23%   |  Test Loss: 0.92442906  |  Test Acc: 76.23%   |  Real True Rate: 0.60%    |
Iteration 92000     |  Loss: 0.69795704  |  Acc: 79.14%   |  Test Loss: 0.85439926  |  Test Acc: 75.41%   |  Real True Rate: 0.20%    |
Iteration 93000     |  Loss: 0.70123130  |  Acc: 79.90%   |  Test Loss: 0.91833854  |  Test Acc: 76.40%   |  Real True Rate: 0.40%    |
Iteration 94000     |  Loss: 0.70781040  |  Acc: 81.20%   |  Test Loss: 0.84455371  |  Test Acc: 75.62%   |  Real True Rate: 0.20%    |
Iteration 95000     |  Loss: 0.73102051  |  Acc: 79.30%   |  Test Loss: 0.91899276  |  Test Acc: 76.69%   |  Real True Rate: 0.40%    |
Iteration 96000     |  Loss: 0.69831687  |  Acc: 79.57%   |  Test Loss: 0.83459729  |  Test Acc: 76.15%   |  Real True Rate: 0.60%    |
Iteration 97000     |  Loss: 0.68591678  |  Acc: 80.16%   |  Test Loss: 0.91545880  |  Test Acc: 76.58%   |  Real True Rate: 0.60%    |
Iteration 98000     |  Loss: 0.66001922  |  Acc: 80.38%   |  Test Loss: 0.83722216  |  Test Acc: 76.18%   |  Real True Rate: 0.20%    |
Iteration 99000     |  Loss: 0.67302132  |  Acc: 79.70%   |  Test Loss: 0.90870422  |  Test Acc: 76.97%   |  Real True Rate: 0.60%    |
Iteration 100000    |  Loss: 0.66629201  |  Acc: 79.50%   |  Test Loss: 0.83539486  |  Test Acc: 76.01%   |  Real True Rate: 0.20%    |
Model saved at iteration 100000
Next learning rate: 0.0
Training finished in 16.0 hours 52.0 minutes 38.20220446586609 seconds
